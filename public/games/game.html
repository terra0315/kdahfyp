<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>K-DAH Safety Symbol Match</title>
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&family=Montserrat:wght@700&display=swap" rel="stylesheet">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    
    <style>
        :root {
            --primary: #00a86b; /* Green accent */
            --primary-light: #4cd08e;
            --primary-dark: #007849;
            --secondary: #ffd100; /* Warning yellow */
            --danger: #e63946;
            --success: #84a98c;
            --bg-dark: #121212; /* Dark background */
            --bg-card: #1e1e1e; /* Card background */
            --text-light: #f8f9fa;
            --text-dark: #e0e0e0;
            --text-muted: #9e9e9e;
            --border: #333333;
            --shadow: rgba(0, 0, 0, 0.25);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Poppins', sans-serif;
            background-color: var(--bg-dark);
            color: var(--text-light);
            min-height: 100vh;
            padding: 0 15px;
        }
        
        .game-container {
            max-width: 1100px;
            margin: 30px auto;
            padding: 30px;
            background-color: var(--bg-card);
            border-radius: 20px;
            box-shadow: 0 10px 30px var(--shadow);
            border: 1px solid #333;
        }
        
        .game-header {
            text-align: center;
            margin-bottom: 35px;
            position: relative;
        }
        
        .logo {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 20px;
        }
        
        .logo img {
            height: 70px;
            margin-right: 15px;
            filter: drop-shadow(0 4px 6px rgba(0, 168, 107, 0.3));
        }
        
        .logo-text {
            display: flex;
            flex-direction: column;
        }
        
        .logo-title {
            font-family: 'Montserrat', sans-serif;
            font-size: 38px;
            font-weight: 700;
            color: var(--primary);
            line-height: 1;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }
        
        .logo-subtitle {
            font-size: 16px;
            color: var(--text-muted);
            letter-spacing: 1px;
        }
        
        .home-button {
            position: absolute;
            top: 20px;
            left: 20px;
            background-color: var(--primary);
            color: white;
            border: none;
            border-radius: 10px;
            padding: 10px 20px;
            font-family: 'Poppins', sans-serif;
            font-weight: 500;
            cursor: pointer;
            display: flex;
            align-items: center;
            transition: all 0.3s ease;
            box-shadow: 0 4px 10px rgba(0, 168, 107, 0.3);
        }
        
        .home-button i {
            margin-right: 10px;
        }
        
        .home-button:hover {
            background-color: var(--primary-light);
            transform: translateY(-3px);
            box-shadow: 0 6px 15px rgba(0, 168, 107, 0.4);
        }
        
        .game-title {
            font-size: 32px;
            margin-bottom: 15px;
            color: var(--primary);
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }
        
        .game-description {
            max-width: 700px;
            margin: 0 auto 25px;
            color: var(--text-dark);
            line-height: 1.6;
            font-size: 17px;
        }
        
        .game-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .info-card {
            background: linear-gradient(135deg, var(--primary-dark), var(--primary));
            color: white;
            padding: 20px;
            border-radius: 15px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            box-shadow: 0 8px 20px rgba(0, 168, 107, 0.25);
            transition: transform 0.3s ease;
        }
        
        .info-card:hover {
            transform: translateY(-5px);
        }
        
        .info-title {
            font-size: 18px;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            color: rgba(255, 255, 255, 0.9);
        }
        
        .info-title i {
            margin-right: 10px;
            font-size: 20px;
        }
        
        .info-value {
            font-size: 28px;
            font-weight: 600;
        }
        
        .difficulty-selection {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 35px;
        }
        
        .difficulty-btn {
            background-color: rgba(255, 255, 255, 0.1);
            border: 2px solid var(--border);
            border-radius: 12px;
            padding: 12px 24px;
            font-family: 'Poppins', sans-serif;
            font-weight: 500;
            font-size: 16px;
            color: var(--text-dark);
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
        
        .difficulty-btn:hover {
            background-color: rgba(0, 168, 107, 0.2);
            border-color: var(--primary);
            transform: translateY(-2px);
        }
        
        .difficulty-btn.active {
            background-color: var(--primary);
            border-color: var(--primary);
            color: white;
            transform: translateY(-3px);
            box-shadow: 0 6px 15px rgba(0, 168, 107, 0.3);
        }
        
        .game-board {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            perspective: 1000px;
            margin-bottom: 35px;
        }
        
        .memory-card {
            height: 160px;
            position: relative;
            transform-style: preserve-3d;
            transform: scale(1);
            transition: transform 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            cursor: pointer;
        }
        
        .memory-card:active {
            transform: scale(0.97);
        }
        
        .memory-card.flipped {
            transform: rotateY(180deg);
        }
        
        .memory-card.matched {
            transform: rotateY(180deg) scale(1.03);
            box-shadow: 0 0 15px var(--primary);
            transition: all 0.6s ease;
        }
        
        .card-inner {
            position: relative;
            width: 100%;
            height: 100%;
            text-align: center;
            transition: transform 0.6s;
            transform-style: preserve-3d;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }
        
        .card-front, .card-back {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }
        
        .card-front {
            background: linear-gradient(145deg, #2a2a2a, #191919);
            color: var(--primary);
            font-size: 36px;
            border: 2px solid #333;
        }
        
        .card-front::after {
            content: '';
            position: absolute;
            width: 120%;
            height: 120%;
            background: linear-gradient(45deg, transparent, rgba(0, 168, 107, 0.2), transparent);
            transform: rotate(45deg);
            top: -100%;
            left: -100%;
            transition: all 0.6s ease;
        }
        
        .memory-card:hover .card-front::after {
            top: 100%;
            left: 100%;
        }
        
        .card-front i {
            text-shadow: 0 0 10px rgba(0, 168, 107, 0.5);
        }
        
        .card-back {
            background-color: #242424;
            transform: rotateY(180deg);
            padding: 15px;
            border: 2px solid var(--primary);
        }
        
        .card-back.symbol {
            font-size: 56px;
            color: var(--primary);
            text-shadow: 0 0 15px rgba(0, 168, 107, 0.6);
        }
        
        .card-back.meaning {
            font-size: 16px;
            font-weight: 500;
            color: var(--text-light);
            line-height: 1.4;
            background: linear-gradient(145deg, #262626, #1a1a1a);
        }
        
        .badge {
            position: absolute;
            top: 10px;
            right: 10px;
            background-color: var(--primary);
            color: white;
            border-radius: 50%;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            font-weight: 600;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.3);
        }
        
        .controls {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .control-btn {
            background-color: var(--primary);
            color: white;
            border: none;
            border-radius: 12px;
            padding: 14px 30px;
            font-family: 'Poppins', sans-serif;
            font-weight: 500;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            box-shadow: 0 6px 15px rgba(0, 168, 107, 0.3);
        }
        
        .control-btn i {
            margin-right: 10px;
            font-size: 18px;
        }
        
        .control-btn:hover {
            background-color: var(--primary-light);
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0, 168, 107, 0.4);
        }
        
        .control-btn:active {
            transform: translateY(-1px);
        }
        
        .control-btn.secondary {
            background-color: rgba(255, 255, 255, 0.1);
            color: var(--text-light);
            border: 2px solid var(--border);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        }
        
        .control-btn.secondary:hover {
            background-color: rgba(255, 255, 255, 0.15);
            border-color: var(--primary);
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.3);
        }
        
        .feedback {
            text-align: center;
            margin-bottom: 20px;
            font-size: 18px;
            font-weight: 500;
            padding: 15px;
            border-radius: 12px;
            transition: all 0.3s ease;
            opacity: 0.9;
        }
        
        .feedback.success {
            background-color: rgba(0, 168, 107, 0.15);
            color: var(--primary-light);
            border-left: 4px solid var(--primary);
        }
        
        .feedback.error {
            background-color: rgba(230, 57, 70, 0.15);
            color: var(--danger);
            border-left: 4px solid var(--danger);
        }
        
        .feedback i {
            margin-right: 8px;
        }
        
        .did-you-know {
            background-color: rgba(0, 168, 107, 0.1);
            border-left: 4px solid var(--primary);
            padding: 20px 25px;
            margin-bottom: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        }
        
        .did-you-know h3 {
            color: var(--primary);
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            font-size: 20px;
        }
        
        .did-you-know h3 i {
            margin-right: 12px;
            font-size: 22px;
        }
        
        .did-you-know p {
            color: var(--text-dark);
            line-height: 1.6;
            font-size: 16px;
        }
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            z-index: 100;
            justify-content: center;
            align-items: center;
            backdrop-filter: blur(5px);
        }
        
        .modal-content {
            background-color: var(--bg-card);
            max-width: 600px;
            width: 90%;
            padding: 40px 30px;
            border-radius: 20px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.4);
            position: relative;
            text-align: center;
            border: 2px solid var(--primary);
            animation: modalAppear 0.5s ease-out forwards;
        }
        
        @keyframes modalAppear {
            from { opacity: 0; transform: scale(0.8); }
            to { opacity: 1; transform: scale(1); }
        }
        
        .close-modal {
            position: absolute;
            top: 20px;
            right: 20px;
            font-size: 28px;
            cursor: pointer;
            color: var(--text-muted);
            transition: color 0.3s ease;
            height: 40px;
            width: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
        }
        
        .close-modal:hover {
            color: var(--primary);
            background-color: rgba(255, 255, 255, 0.1);
        }
        
        .medal-icon {
            font-size: 80px;
            color: var(--secondary);
            margin-bottom: 25px;
            animation: pulse 1.5s infinite;
            text-shadow: 0 0 20px rgba(255, 209, 0, 0.5);
        }
        
        .modal h2 {
            color: var(--primary);
            margin-bottom: 20px;
            font-size: 32px;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }
        
        .modal p {
            margin-bottom: 30px;
            color: var(--text-dark);
            font-size: 18px;
            line-height: 1.6;
        }
        
        .modal-btn {
            background-color: var(--primary);
            color: white;
            border: none;
            border-radius: 12px;
            padding: 14px 35px;
            font-family: 'Poppins', sans-serif;
            font-weight: 500;
            font-size: 18px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 6px 15px rgba(0, 168, 107, 0.3);
        }
        
        .modal-btn:hover {
            background-color: var(--primary-light);
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0, 168, 107, 0.4);
        }
        
        .stats {
            display: flex;
            justify-content: space-around;
            margin-bottom: 30px;
            background-color: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2) inset;
        }
        
        .stat {
            text-align: center;
            padding: 0 15px;
            position: relative;
        }
        
        .stat:not(:last-child)::after {
            content: '';
            position: absolute;
            right: 0;
            top: 20%;
            height: 60%;
            width: 1px;
            background-color: rgba(255, 255, 255, 0.1);
        }
        
        .stat-value {
            font-size: 32px;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 5px;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }
        
        .stat-label {
            color: var(--text-muted);
            font-size: 16px;
            text-transform: uppercase;
            letter-spacing: 1px;
            font-weight: 500;
        }
        
        @keyframes pulse {
            0% {
                transform: scale(1);
                opacity: 1;
            }
            50% {
                transform: scale(1.15);
                opacity: 0.9;
            }
            100% {
                transform: scale(1);
                opacity: 1;
            }
        }
        
        @keyframes confetti {
            0% {
                transform: translateY(0) rotate(0);
                opacity: 1;
            }
            100% {
                transform: translateY(100vh) rotate(720deg);
                opacity: 0;
            }
        }
        
        .confetti-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 999;
            overflow: hidden;
        }
        
        .confetti {
            position: absolute;
            width: 12px;
            height: 12px;
            opacity: 0;
            border-radius: 4px;
        }
        
        @media (max-width: 768px) {
            .game-board {
                grid-template-columns: repeat(3, 1fr);
                gap: 15px;
            }
            
            .memory-card {
                height: 130px;
            }
            
            .card-back.meaning {
                font-size: 14px;
            }
            
            .difficulty-selection {
                flex-wrap: wrap;
            }
            
            .logo-title {
                font-size: 32px;
            }
            
            .game-title {
                font-size: 28px;
            }
        }
        
        @media (max-width: 576px) {
            .game-container {
                padding: 20px 15px;
                margin: 15px auto;
            }
            
            .game-board {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .info-card {
                min-width: 100%;
            }
            
            .controls {
                flex-direction: column;
                gap: 15px;
            }
            
            .home-button {
                position: static;
                margin-bottom: 15px;
                width: 100%;
                justify-content: center;
            }
            
            .logo {
                flex-direction: column;
                text-align: center;
            }
            
            .logo img {
                margin-right: 0;
                margin-bottom: 10px;
            }
            
            .logo-title {
                font-size: 28px;
            }
            
            .game-title {
                font-size: 24px;
            }
            
            .card-back.symbol {
                font-size: 40px;
            }
            
            .feedback {
                font-size: 16px;
            }
            
            .stats {
                flex-direction: column;
                gap: 20px;
            }
            
            .stat:not(:last-child)::after {
                content: '';
                position: absolute;
                right: 0;
                bottom: -10px;
                height: 1px;
                width: 60%;
                left: 20%;
                top: auto;
                background-color: rgba(255, 255, 255, 0.1);
            }
        }
        
        .info-popup {
            display: none;
            position: fixed;
            top: 20px;
            right: 20px;
            width: 350px;
            max-width: 90vw;
            z-index: 100;
            pointer-events: none;
        }
        
        .info-popup-content {
            background-color: var(--bg-card);
            padding: 20px;
            border-radius: 16px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.4);
            position: relative;
            border: 2px solid var(--primary);
            animation: slideInRight 0.4s ease-out forwards;
            pointer-events: auto;
            transform-origin: top right;
            overflow: hidden;
            max-height: 80vh;
            overflow-y: auto;
        }
        
        .info-popup-header {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            padding-bottom: 12px;
        }
        
        .info-popup-icon {
            font-size: 28px;
            color: var(--primary);
            margin-right: 12px;
            min-width: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .info-popup-title {
            font-size: 18px;
            font-weight: 600;
            color: var(--primary);
            text-align: left;
        }
        
        .info-popup-body {
            text-align: left;
        }
        
        .info-section {
            margin-bottom: 12px;
        }
        
        .info-section h4 {
            color: var(--text-light);
            font-size: 14px;
            margin-bottom: 6px;
            display: flex;
            align-items: center;
        }
        
        .info-section h4 i {
            margin-right: 8px;
            color: var(--primary);
        }
        
        .info-section p {
            color: var(--text-dark);
            font-size: 13px;
            line-height: 1.4;
            margin-bottom: 8px;
        }
        
        .resource-links {
            background-color: rgba(0, 168, 107, 0.1);
            border-radius: 8px;
            padding: 10px 12px;
            margin-top: 12px;
        }
        
        .resource-links h4 {
            display: flex;
            align-items: center;
            color: var(--primary);
            font-size: 14px;
            margin-bottom: 8px;
        }
        
        .resource-links h4 i {
            margin-right: 8px;
        }
        
        .resource-link {
            display: flex;
            align-items: center;
            color: var(--text-light);
            text-decoration: none;
            padding: 6px 0;
            transition: all 0.3s ease;
            border-radius: 5px;
            margin-bottom: 4px;
            font-size: 13px;
        }
        
        .resource-link:hover {
            background-color: rgba(0, 168, 107, 0.15);
            padding-left: 8px;
        }
        
        .resource-link i {
            margin-right: 8px;
            color: var(--primary);
        }
        
        .close-info {
            position: absolute;
            top: 10px;
            right: 10px;
            font-size: 18px;
            cursor: pointer;
            color: var(--text-muted);
            transition: color 0.3s ease;
            height: 26px;
            width: 26px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            background-color: rgba(255, 255, 255, 0.05);
        }
        
        .close-info:hover {
            color: var(--primary);
            background-color: rgba(255, 255, 255, 0.1);
        }
        
        .popup-btn {
            display: none; /* Hide the continue button as it's not needed for a side notification */
        }
        
        @keyframes slideInRight {
            from { opacity: 0; transform: translateX(50px); }
            to { opacity: 1; transform: translateX(0); }
        }
        
        @keyframes slideOutRight {
            from { opacity: 1; transform: translateX(0); }
            to { opacity: 0; transform: translateX(50px); }
        }
        
        .info-popup.hiding .info-popup-content {
            animation: slideOutRight 0.3s ease-in forwards;
        }
    </style>
</head>

<body>
    <div class="game-container">
        <div class="game-header">
            <button class="home-button" onclick="location.href='/'">
                <i class="fas fa-home"></i> Back to Home
            </button>
            <div class="logo">
                <img src="/images/bg7.png" alt="K-DAH Logo">
                <div class="logo-text">
                    <span class="logo-title">K-DAH</span>
                    <span class="logo-subtitle">Klang Disaster Awareness Hub</span>
                </div>
            </div>
            <h1 class="game-title">Safety Symbol Match Challenge</h1>
            <p class="game-description">Test your knowledge of disaster safety symbols and their meanings. Match each symbol with its correct description to complete the challenge. Learn about important safety indicators that could save lives during emergencies!</p>
        </div>
        
        <div class="game-info">
            <div class="info-card">
                <div class="info-title">
                    <i class="fas fa-stopwatch"></i> Time
                </div>
                <div class="info-value" id="time-display">00:00</div>
            </div>
            <div class="info-card">
                <div class="info-title">
                    <i class="fas fa-check-double"></i> Matches
                </div>
                <div class="info-value"><span id="matches-count">0</span>/<span id="total-pairs">0</span></div>
            </div>
            <div class="info-card">
                <div class="info-title">
                    <i class="fas fa-mouse-pointer"></i> Moves
                </div>
                <div class="info-value" id="moves-count">0</div>
            </div>
        </div>
        
        <div class="difficulty-selection">
            <button class="difficulty-btn active" data-pairs="6">Beginner</button>
            <button class="difficulty-btn" data-pairs="8">Intermediate</button>
            <button class="difficulty-btn" data-pairs="12">Expert</button>
        </div>
        
        <div id="game-board" class="game-board">
            <!-- Cards will be generated here -->
        </div>
        
        <div class="controls">
            <button id="restart-btn" class="control-btn">
                <i class="fas fa-redo"></i> Restart Game
            </button>
            <button id="how-to-play-btn" class="control-btn secondary">
                <i class="fas fa-question-circle"></i> How To Play
            </button>
            <button id="hint-btn" class="control-btn secondary">
                <i class="fas fa-lightbulb"></i> Show Hint
            </button>
        </div>
        
        <div id="feedback" class="feedback"></div>
        
        <div class="did-you-know">
            <h3><i class="fas fa-info-circle"></i>Did You Know?</h3>
            <p id="fact-text">During the 2021 Klang flood disaster, over 50,000 residents had to be evacuated. Recognizing warning symbols early could have helped many families prepare sooner.</p>
        </div>
    </div>
    
    <div id="completion-modal" class="modal">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <i class="fas fa-medal medal-icon"></i>
            <h2>Congratulations!</h2>
            <p>You've successfully matched all the safety symbols!</p>
            <div class="stats">
                <div class="stat">
                    <div class="stat-value" id="final-time">00:00</div>
                    <div class="stat-label">Time</div>
                </div>
                <div class="stat">
                    <div class="stat-value" id="final-moves">0</div>
                    <div class="stat-label">Moves</div>
                </div>
                <div class="stat">
                    <div class="stat-value" id="final-score">0</div>
                    <div class="stat-label">Score</div>
                </div>
            </div>
            <p>You're now better prepared to identify crucial safety symbols during emergencies!</p>
            <button id="play-again" class="modal-btn">Play Again</button>
        </div>
    </div>
    
    <!-- Information Popup for Symbol Matches -->
    <div id="info-popup" class="info-popup">
        <div class="info-popup-content">
            <span class="close-info" id="close-info">&times;</span>
            <div class="info-popup-header">
                <div class="info-popup-icon" id="info-symbol"><i class="fas fa-water"></i></div>
                <div class="info-popup-title" id="info-title">Flood Warning</div>
            </div>
            <div class="info-popup-body">
                <div class="info-section">
                    <h4><i class="fas fa-info-circle"></i>What This Symbol Means</h4>
                    <p id="info-meaning">This symbol indicates areas that are at risk of flooding or currently experiencing flooding conditions.</p>
                </div>
                <div class="info-section">
                    <h4><i class="fas fa-exclamation-circle"></i>Why It's Important</h4>
                    <p id="info-importance">Recognizing flood warnings allows you to evacuate early and take necessary precautions to protect yourself and your property.</p>
                </div>
                <div class="info-section">
                    <h4><i class="fas fa-lightbulb"></i>Real-Life Scenario</h4>
                    <p id="info-scenario">During the 2021 Klang Valley floods, residents who recognized this symbol early were able to move valuable belongings to higher ground and evacuate before roads became impassable.</p>
                </div>
                <div class="resource-links">
                    <h4><i class="fas fa-external-link-alt"></i>Learn More</h4>
                    <div id="info-links">
                        <a href="#" class="resource-link"><i class="fas fa-file-alt"></i>Flood Safety Guidelines</a>
                        <a href="#" class="resource-link"><i class="fas fa-map-marked-alt"></i>Klang Flood Prone Areas</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- How To Play Modal -->
    <div id="how-to-play-modal" class="modal">
        <div class="modal-content">
            <span class="close-modal" id="close-how-to-play">&times;</span>
            <i class="fas fa-gamepad" style="font-size: 60px; color: var(--primary); margin-bottom: 20px;"></i>
            <h2>How To Play</h2>
            <div style="text-align: left; margin-bottom: 20px;">
                <p style="margin-bottom: 15px;"><i class="fas fa-check-circle" style="color: var(--primary); margin-right: 10px;"></i> <strong>Objective:</strong> Match each safety symbol with its correct meaning.</p>
                <p style="margin-bottom: 15px;"><i class="fas fa-check-circle" style="color: var(--primary); margin-right: 10px;"></i> <strong>Game Flow:</strong> Click on cards to flip them. Try to remember the position of each card.</p>
                <p style="margin-bottom: 15px;"><i class="fas fa-check-circle" style="color: var(--primary); margin-right: 10px;"></i> <strong>Matching:</strong> When you find a matching pair (symbol + meaning), they will remain face up.</p>
                <p style="margin-bottom: 15px;"><i class="fas fa-check-circle" style="color: var(--primary); margin-right: 10px;"></i> <strong>Learn:</strong> Each matched pair will show an information popup with details about the safety symbol.</p>
                <p style="margin-bottom: 15px;"><i class="fas fa-check-circle" style="color: var(--primary); margin-right: 10px;"></i> <strong>Difficulty:</strong> Choose from Beginner (6 pairs), Intermediate (8 pairs), or Expert (12 pairs).</p>
                <p style="margin-bottom: 15px;"><i class="fas fa-check-circle" style="color: var(--primary); margin-right: 10px;"></i> <strong>Hint:</strong> Use the hint button if you're stuck (available every 30 seconds).</p>
                <p><i class="fas fa-check-circle" style="color: var(--primary); margin-right: 10px;"></i> <strong>Win:</strong> Match all pairs to complete the game and see your final score!</p>
            </div>
            <p style="margin-bottom: 15px; font-style: italic;">Understanding safety symbols is crucial during emergencies in Klang. This game helps you learn these important indicators while having fun!</p>
            <button id="start-playing" class="modal-btn">Start Playing</button>
        </div>
    </div>
    
    <div class="confetti-container" id="confetti-container"></div>
    
    <script>
        // Safety symbol data with Klang disaster relevance
        const symbolsData = [
            { 
                id: 1, 
                symbol: "fas fa-water", 
                meaning: "Flood Warning - Areas at risk of flooding in Klang Valley",
                detail: "Indicates areas at high risk of flooding due to heavy rainfall, river overflow, or coastal surge.",
                importance: "Flooding is the most common disaster in the Klang Valley. This symbol helps identify danger zones where water levels may rise rapidly.",
                scenario: "During the 2021 Klang floods, residents who heeded flood warnings had up to 4 additional hours to evacuate before areas became inaccessible.",
                links: [
                    {name: "Flood Safety Guidelines", url: "/resources/flood-safety", icon: "fas fa-file-alt"},
                    {name: "Klang Flood Prone Areas Map", url: "/maps/flood-zones", icon: "fas fa-map-marked-alt"},
                    {name: "Emergency Contact Information", url: "/emergency-contacts", icon: "fas fa-phone-alt"}
                ]
            },
            { 
                id: 2, 
                symbol: "fas fa-house-damage", 
                meaning: "Structural Damage - Warning for buildings impacted by disasters",
                detail: "Indicates buildings that have been structurally compromised due to disasters like floods, earthquakes, or landslides.",
                importance: "Entering damaged buildings can be life-threatening. This symbol warns you to stay away from unstable structures.",
                scenario: "Following the 2017 landslide in Taman Bukit Mewah, Klang, these symbols helped emergency services identify dangerous structures and prevented additional casualties.",
                links: [
                    {name: "Building Safety After Disasters", url: "/resources/building-safety", icon: "fas fa-hard-hat"},
                    {name: "Structural Integrity Assessment", url: "/resources/structural-assessment", icon: "fas fa-clipboard-check"},
                    {name: "Temporary Housing Options", url: "/services/temporary-housing", icon: "fas fa-home"}
                ]
            },
            { 
                id: 3, 
                symbol: "fas fa-first-aid", 
                meaning: "First Aid Station - Medical assistance locations during emergencies",
                detail: "Marks locations where basic medical assistance, first aid supplies, and trained personnel can be found during emergencies.",
                importance: "During disasters, quick access to medical care can be life-saving. These stations provide immediate treatment for non-critical injuries.",
                scenario: "When flash floods hit Taman Sri Muda in 2021, first aid stations treated over 200 minor injuries in the first 24 hours, preventing hospital overwhelm.",
                links: [
                    {name: "Basic First Aid Tutorial", url: "/resources/first-aid-basics", icon: "fas fa-medkit"},
                    {name: "Medical Centers in Klang", url: "/services/medical-centers", icon: "fas fa-hospital"},
                    {name: "First Aid Kit Checklist", url: "/resources/first-aid-kit", icon: "fas fa-clipboard-list"}
                ]
            },
            { 
                id: 4, 
                symbol: "fas fa-phone", 
                meaning: "Emergency Contact - Call 991 for Malaysian Civil Defense in Klang",
                detail: "Indicates locations with emergency communications or reminds of the emergency contact number for Civil Defense (991) in Malaysia.",
                importance: "When disaster strikes, knowing the correct emergency number saves crucial minutes in response time.",
                scenario: "During the 2021 floods, the Civil Defense Force rescued over 500 Klang residents who called the emergency line when water levels rose unexpectedly overnight.",
                links: [
                    {name: "Emergency Numbers List", url: "/emergency-contacts", icon: "fas fa-phone-alt"},
                    {name: "Civil Defense Services", url: "/services/civil-defense", icon: "fas fa-shield-alt"},
                    {name: "When to Call Each Emergency Service", url: "/resources/emergency-services-guide", icon: "fas fa-info-circle"}
                ]
            },
            { 
                id: 5, 
                symbol: "fas fa-map-marker-alt", 
                meaning: "Evacuation Point - Safe gathering locations during disasters",
                detail: "Marks designated safe locations where people should gather during evacuations for assistance and further transportation.",
                importance: "Evacuation points are carefully selected high ground areas with essential supplies and transportation access.",
                scenario: "The Shah Alam Stadium evacuation point sheltered over 2,000 people during the December 2021 floods, providing food, water, and medical care.",
                links: [
                    {name: "Klang Evacuation Centers Map", url: "/maps/evacuation-centers", icon: "fas fa-map-marked-alt"},
                    {name: "Evacuation Preparation Guide", url: "/guides/evacuation-preparation", icon: "fas fa-clipboard-check"},
                    {name: "What to Bring When Evacuating", url: "/resources/evacuation-essentials", icon: "fas fa-suitcase"}
                ]
            },
            { 
                id: 6, 
                symbol: "fas fa-exclamation-triangle", 
                meaning: "Hazard Warning - Areas with potential danger in disaster zones",
                detail: "A general warning symbol indicating various potential hazards that require caution in disaster-affected areas.",
                importance: "This versatile symbol alerts you to multiple potential dangers that might not have specific warning signs.",
                scenario: "After the 2021 floods receded in Klang, hazard warnings marked areas with contaminated water, unstable ground, and damaged electrical systems.",
                links: [
                    {name: "Common Post-Disaster Hazards", url: "/resources/post-disaster-hazards", icon: "fas fa-exclamation-circle"},
                    {name: "Hazard Reporting System", url: "/services/report-hazard", icon: "fas fa-flag"},
                    {name: "Safety Around Flood Debris", url: "/guides/flood-debris-safety", icon: "fas fa-trash"}
                ]
            },
            { 
                id: 7, 
                symbol: "fas fa-fire", 
                meaning: "Fire Hazard - Areas at risk during drought conditions in Klang",
                detail: "Indicates areas with high fire risk due to drought conditions, electrical hazards, or flammable materials.",
                importance: "Though Klang is prone to flooding, fire hazards increase during dry seasons and can be catastrophic in densely populated areas.",
                scenario: "The 2019 dry season led to several factory fires in Port Klang industrial areas, where this symbol helped identify high-risk zones for monitoring.",
                links: [
                    {name: "Fire Safety Guidelines", url: "/resources/fire-safety", icon: "fas fa-fire-extinguisher"},
                    {name: "Drought Conditions Updates", url: "/alerts/drought-conditions", icon: "fas fa-sun"},
                    {name: "Home Fire Prevention Tips", url: "/guides/fire-prevention", icon: "fas fa-home"}
                ]
            },
            { 
                id: 8, 
                symbol: "fas fa-hand-holding-water", 
                meaning: "Drinking Water - Safe water distribution points during floods",
                detail: "Marks locations where safe, potable water is available during emergencies when normal water supplies are compromised.",
                importance: "Access to clean drinking water is critical during floods as regular water sources often become contaminated.",
                scenario: "During the 2021 floods, these distribution points provided over 500,000 liters of clean water to Klang residents when municipal systems failed.",
                links: [
                    {name: "Water Purification Methods", url: "/guides/water-purification", icon: "fas fa-tint-slash"},
                    {name: "Water-borne Disease Prevention", url: "/health/waterborne-diseases", icon: "fas fa-virus"},
                    {name: "Water Supply Status Updates", url: "/alerts/water-supply", icon: "fas fa-faucet"}
                ]
            },
            { 
                id: 9, 
                symbol: "fas fa-charging-station", 
                meaning: "Charging Station - Emergency power for communications during outages",
                detail: "Indicates locations with emergency power sources where electronic devices can be charged during power outages.",
                importance: "Maintaining communication capabilities during disasters is essential for receiving emergency information and contacting help.",
                scenario: "When Klang experienced a 3-day power outage following the 2021 floods, these stations helped residents maintain contact with emergency services and family.",
                links: [
                    {name: "Power Outage Preparedness", url: "/guides/power-outage-prep", icon: "fas fa-lightbulb"},
                    {name: "Emergency Communication Plan", url: "/guides/emergency-communication", icon: "fas fa-comments"},
                    {name: "Battery Conservation Tips", url: "/resources/battery-conservation", icon: "fas fa-battery-half"}
                ]
            },
            { 
                id: 10, 
                symbol: "fas fa-heartbeat", 
                meaning: "Medical Emergency - Critical care needed during disasters",
                detail: "Indicates locations where advanced medical care is available or marks situations requiring urgent medical attention.",
                importance: "During disasters, knowing where to find advanced medical care can be the difference between life and death.",
                scenario: "Medical emergency stations set up at Tengku Ampuan Rahimah Hospital during the 2021 floods treated over 150 critical patients in 48 hours.",
                links: [
                    {name: "Emergency Medical Centers", url: "/services/emergency-medical", icon: "fas fa-hospital"},
                    {name: "Recognizing Medical Emergencies", url: "/guides/medical-emergency-signs", icon: "fas fa-procedures"},
                    {name: "Chronic Condition Management During Disasters", url: "/health/chronic-conditions", icon: "fas fa-pills"}
                ]
            },
            { 
                id: 11, 
                symbol: "fas fa-wind", 
                meaning: "Strong Winds - Warning for monsoon seasons affecting Klang",
                detail: "Indicates areas at risk from strong winds, storms, or monsoon conditions that could cause damage.",
                importance: "Strong winds can damage structures, create dangerous flying debris, and exacerbate flooding conditions during monsoons.",
                scenario: "During the 2022 monsoon season, wind warnings helped Klang residents secure properties before 90km/h gusts caused widespread roof damage.",
                links: [
                    {name: "Monsoon Preparation Guide", url: "/guides/monsoon-preparation", icon: "fas fa-cloud-rain"},
                    {name: "Wind Damage Prevention", url: "/resources/wind-damage-prevention", icon: "fas fa-house-damage"},
                    {name: "Weather Alert System", url: "/services/weather-alerts", icon: "fas fa-bell"}
                ]
            },
            { 
                id: 12, 
                symbol: "fas fa-broadcast-tower", 
                meaning: "Emergency Broadcast - Information points during crisis situations",
                detail: "Marks locations where official emergency information is broadcast or can be accessed during disasters.",
                importance: "Accurate, timely information is crucial during emergencies. These stations provide official updates and instructions.",
                scenario: "Emergency broadcast points throughout Klang provided hourly updates during the 2021 floods, directing evacuations and resource distribution.",
                links: [
                    {name: "Emergency Alert Channels", url: "/resources/emergency-alerts", icon: "fas fa-satellite-dish"},
                    {name: "Official Information Sources", url: "/resources/official-sources", icon: "fas fa-check-circle"},
                    {name: "Disaster Communication Plan", url: "/guides/disaster-communication", icon: "fas fa-comments"}
                ]
            }
        ];
        
        // Disaster awareness facts for the "Did You Know" section
        const disasterFacts = [
            "During the 2021 Klang flood disaster, over 50,000 residents had to be evacuated. Recognizing warning symbols early could have helped many families prepare sooner.",
            "Port Klang is particularly vulnerable to flooding due to its low elevation and proximity to rivers and the sea.",
            "Flash floods in Klang can develop in less than 6 hours after heavy rainfall. Having an emergency plan can reduce evacuation time by 50%.",
            "The Malaysian Meteorological Department uses specific warning symbols to indicate different levels of flood risks in the Klang Valley.",
            "The 2021 floods in Klang caused approximately RM6.1 billion in damages. Proper disaster preparedness could have reduced this figure significantly.",
            "Klang experiences an average of 2,670 mm of rainfall annually, making it one of Malaysia's wettest urban areas and increasing flood risks.",
            "Emergency evacuation symbols in Klang follow international standards but include local adaptations for specific regional hazards.",
            "During the 2021 floods, some rescue operations in Klang were delayed because residents couldn't identify official emergency vehicles and personnel.",
            "The Klang Municipal Council has established 24 designated emergency evacuation centers, each marked with specific safety symbols.",
            "Understanding flood warning symbols in Klang can give residents up to 3 additional hours of preparation time before evacuation becomes necessary.",
            "Taman Sri Muda in Klang was among the hardest-hit areas during the 2021 floods, where rescue boats had to navigate submerged streets to reach stranded residents.",
            "Many areas in Klang lie below sea level, making them highly susceptible to tidal flooding during heavy rain and high tide events.",
            "Over 70% of households affected in the Klang 2021 disaster reported having no prior disaster preparedness training or plan.",
            "Localized thunderstorms in Klang can lead to urban flash floods, especially in areas with poor drainage such as Meru and Pandamaran.",
            "The Klang River, which runs through the district, often overflows during monsoon season, impacting residential and commercial zones nearby.",
            "The Department of Irrigation and Drainage Malaysia (JPS) has identified Klang as one of the country's high-priority flood mitigation zones.",
            "Real-time weather monitoring stations around Klang help detect rapid changes in rainfall and flood risk levels, feeding data into early warning systems.",
            "In some Klang neighborhoods, emergency sirens are installed to alert residents of imminent disastersâ€”but many are unaware of their meaning or sound patterns.",
            "Infrastructure damage from the 2021 Klang floods included not only homes but also schools, clinics, and major roadways like the Federal Highway.",
            "Community-led disaster awareness programs in Klang have shown a 35% increase in household preparedness within participating zones."
        ];
        
        // Game variables
        let cards = [];
        let flippedCards = [];
        let matchedPairs = 0;
        let totalPairs = 6; // Default for beginner
        let moves = 0;
        let isProcessing = false;
        let gameStarted = false;
        let gameTimer;
        let seconds = 0;
        let canShowHint = true;
        let hintTimeout;
        
        // DOM elements
        const gameBoard = document.getElementById("game-board");
        const matchesDisplay = document.getElementById("matches-count");
        const totalPairsDisplay = document.getElementById("total-pairs");
        const movesDisplay = document.getElementById("moves-count");
        const timeDisplay = document.getElementById("time-display");
        const feedbackElement = document.getElementById("feedback");
        const factText = document.getElementById("fact-text");
        const completionModal = document.getElementById("completion-modal");
        const finalTimeDisplay = document.getElementById("final-time");
        const finalMovesDisplay = document.getElementById("final-moves");
        const finalScoreDisplay = document.getElementById("final-score");
        const confettiContainer = document.getElementById("confetti-container");
        const howToPlayModal = document.getElementById("how-to-play-modal");
        
        // Initialize game
        document.addEventListener('DOMContentLoaded', function() {
            // Set up difficulty buttons
            const difficultyButtons = document.querySelectorAll('.difficulty-btn');
            difficultyButtons.forEach(button => {
                button.addEventListener('click', function() {
                    difficultyButtons.forEach(btn => btn.classList.remove('active'));
                    this.classList.add('active');
                    totalPairs = parseInt(this.dataset.pairs);
                    totalPairsDisplay.textContent = totalPairs;
                    resetGame();
                });
            });
            
            // Set up restart button
            document.getElementById("restart-btn").addEventListener('click', resetGame);
            
            // Set up hint button
            document.getElementById("hint-btn").addEventListener('click', showHint);
            
            // Set up how to play button
            document.getElementById("how-to-play-btn").addEventListener('click', function() {
                howToPlayModal.style.display = "flex";
            });
            
            // Set up start playing button in how to play modal
            document.getElementById("start-playing").addEventListener('click', function() {
                howToPlayModal.style.display = "none";
            });
            
            // Close how to play modal when clicking X
            document.getElementById("close-how-to-play").addEventListener('click', function() {
                howToPlayModal.style.display = "none";
            });
            
            // Set up play again button
            document.getElementById("play-again").addEventListener('click', function() {
                completionModal.style.display = "none";
                resetGame();
            });
            
            // Close modal when clicking X
            document.querySelector(".close-modal").addEventListener('click', function() {
                completionModal.style.display = "none";
            });
            
            // Initialize the game
            resetGame();
            
            // Display random fact
            displayRandomFact();
        });
        
        // Start or reset the game
        function resetGame() {
            // Clear the game board
            gameBoard.innerHTML = "";
            
            // Reset game variables
            cards = [];
            flippedCards = [];
            matchedPairs = 0;
            moves = 0;
            isProcessing = false;
            
            // Reset displays
            matchesDisplay.textContent = "0";
            totalPairsDisplay.textContent = totalPairs;
            movesDisplay.textContent = "0";
            timeDisplay.textContent = "00:00";
            feedbackElement.textContent = "";
            feedbackElement.className = "feedback";
            
            // Reset timer
            clearInterval(gameTimer);
            seconds = 0;
            gameStarted = false;
            
            // Reset hint
            canShowHint = true;
            clearTimeout(hintTimeout);
            
            // Create cards based on difficulty
            createCards();
        }
        
        // Create cards for the game
        function createCards() {
            // Get symbols based on selected difficulty
            const selectedSymbols = symbolsData.slice(0, totalPairs);
            
            // Create pairs (symbol + meaning)
            cards = [];
            selectedSymbols.forEach(item => {
                // Symbol card
                cards.push({
                    id: item.id,
                    type: 'symbol',
                    content: item.symbol,
                    pairId: item.id
                });
                
                // Meaning card
                cards.push({
                    id: item.id + 100, // Different ID but same pairId
                    type: 'meaning',
                    content: item.meaning,
                    pairId: item.id
                });
            });
            
            // Shuffle cards
            cards = shuffleArray(cards);
            
            // Determine grid columns based on number of cards
            const totalCards = cards.length;
            let gridColumns;
            
            if (totalCards <= 12) {
                gridColumns = 4;
            } else if (totalCards <= 16) {
                gridColumns = 4;
            } else {
                gridColumns = 6;
            }
            
            gameBoard.style.gridTemplateColumns = `repeat(${gridColumns}, 1fr)`;
            
            // Create and add cards to the board
            cards.forEach((card, index) => {
                const cardElement = document.createElement("div");
                cardElement.className = "memory-card";
                cardElement.dataset.index = index;
                cardElement.dataset.pairId = card.pairId;
                
                const cardInner = document.createElement("div");
                cardInner.className = "card-inner";
                
                const cardFront = document.createElement("div");
                cardFront.className = "card-front";
                cardFront.innerHTML = `<i class="fas fa-question"></i>`;
                
                const cardBack = document.createElement("div");
                if (card.type === 'symbol') {
                    cardBack.className = "card-back symbol";
                    cardBack.innerHTML = `<i class="${card.content}"></i>`;
                } else {
                    cardBack.className = "card-back meaning";
                    cardBack.textContent = card.content;
                }
                
                const badge = document.createElement("div");
                badge.className = "badge";
                badge.textContent = card.pairId;
                cardBack.appendChild(badge);
                
                cardInner.appendChild(cardFront);
                cardInner.appendChild(cardBack);
                cardElement.appendChild(cardInner);
                
                cardElement.addEventListener("click", flipCard);
                gameBoard.appendChild(cardElement);
            });
        }
        
        // Flip card when clicked
        function flipCard() {
            if (isProcessing) return;
            if (this.classList.contains("flipped") || this.classList.contains("matched")) return;
            
            // Start timer on first move
            if (!gameStarted) {
                startTimer();
                gameStarted = true;
            }
            
            // Flip card
            this.classList.add("flipped");
            
            // Add to flipped cards
            flippedCards.push(this);
            
            // Check if two cards are flipped
            if (flippedCards.length === 2) {
                // Increment moves
                moves++;
                movesDisplay.textContent = moves;
                
                // Check for match
                isProcessing = true;
                setTimeout(checkForMatch, 800);
            }
        }
        
        // Check if two flipped cards match
        function checkForMatch() {
            const card1 = flippedCards[0];
            const card2 = flippedCards[1];
            
            if (card1.dataset.pairId === card2.dataset.pairId) {
                // Match found
                card1.classList.add("matched");
                card2.classList.add("matched");
                matchedPairs++;
                matchesDisplay.textContent = matchedPairs;
                
                // Add success feedback
                showFeedback(`Great match! You correctly identified a safety symbol.`, "success");
                
                // Display information popup for the matched symbol
                showInfoPopup(card1.dataset.pairId);
                
                // Update random fact
                displayRandomFact();
                
                // Check if game completed
                if (matchedPairs === totalPairs) {
                    gameCompleted();
                }
            } else {
                // No match
                setTimeout(() => {
                    card1.classList.remove("flipped");
                    card2.classList.remove("flipped");
                }, 500);
                
                // Show feedback
                showFeedback("Not a match. Try again!", "error");
            }
            
            // Reset flipped cards
            flippedCards = [];
            isProcessing = false;
        }
        
        // Show hint by briefly flipping a pair of unmatched cards
        function showHint() {
            if (!canShowHint || !gameStarted) return;
            
            // Find unmatched pairs
            const unmatchedCards = Array.from(document.querySelectorAll(".memory-card:not(.matched)"));
            if (unmatchedCards.length === 0) return;
            
            // Group by pairId and find first unmatched pair
            const pairGroups = {};
            unmatchedCards.forEach(card => {
                const pairId = card.dataset.pairId;
                if (!pairGroups[pairId]) pairGroups[pairId] = [];
                pairGroups[pairId].push(card);
            });
            
            // Find first complete pair
            let hintPair = null;
            for (const pairId in pairGroups) {
                if (pairGroups[pairId].length === 2) {
                    hintPair = pairGroups[pairId];
                    break;
                }
            }
            
            if (!hintPair) return;
            
            // Show hint
            canShowHint = false;
            document.getElementById("hint-btn").disabled = true;
            document.getElementById("hint-btn").style.opacity = "0.5";
            
            hintPair.forEach(card => card.classList.add("flipped"));
            
            // Hide hint after a brief moment
            setTimeout(() => {
                hintPair.forEach(card => {
                    if (!card.classList.contains("matched")) {
                        card.classList.remove("flipped");
                    }
                });
            }, 1000);
            
            // Allow hint again after 30 seconds
            hintTimeout = setTimeout(() => {
                canShowHint = true;
                document.getElementById("hint-btn").disabled = false;
                document.getElementById("hint-btn").style.opacity = "1";
            }, 30000);
        }
        
        // Start game timer
        function startTimer() {
            // Clear any existing timer before starting a new one
            clearInterval(gameTimer);
            
            gameTimer = setInterval(() => {
                seconds++;
                const min = Math.floor(seconds / 60);
                const sec = seconds % 60;
                timeDisplay.textContent = `${min.toString().padStart(2, '0')}:${sec.toString().padStart(2, '0')}`;
            }, 1000);
        }
        
        // Display random fact in "Did You Know" section
        function displayRandomFact() {
            const randomIndex = Math.floor(Math.random() * disasterFacts.length);
            factText.textContent = disasterFacts[randomIndex];
        }
        
        // Game completion handler
        function gameCompleted() {
            clearInterval(gameTimer);
            
            // Calculate score (based on speed and moves)
            const baseScore = 1000;
            const timeDeduction = Math.floor(seconds / 5);
            const movesDeduction = Math.floor(moves * 10);
            const difficultyBonus = totalPairs * 50;
            const finalScore = Math.max(baseScore - timeDeduction - movesDeduction + difficultyBonus, 0);
            
            // Update completion modal
            finalTimeDisplay.textContent = timeDisplay.textContent;
            finalMovesDisplay.textContent = moves;
            finalScoreDisplay.textContent = finalScore;
            
            // Show modal after a short delay
            setTimeout(() => {
                completionModal.style.display = "flex";
                showConfetti();
            }, 1000);
        }
        
        // Create confetti effect for celebration
        function showConfetti() {
            confettiContainer.innerHTML = '';
            const colors = ['#ffd700', '#ff6b6b', '#4ecdc4', '#45b7d8', '#f9a825'];
            
            for (let i = 0; i < 100; i++) {
                const confetti = document.createElement('div');
                confetti.className = 'confetti';
                
                // Random position, color and size
                const size = Math.random() * 10 + 5;
                const color = colors[Math.floor(Math.random() * colors.length)];
                
                confetti.style.left = Math.random() * 100 + 'vw';
                confetti.style.width = size + 'px';
                confetti.style.height = size + 'px';
                confetti.style.backgroundColor = color;
                confetti.style.opacity = '1';
                
                // Animation
                confetti.style.animation = `confetti ${Math.random() * 3 + 2}s linear forwards`;
                confetti.style.animationDelay = Math.random() * 5 + 's';
                
                confettiContainer.appendChild(confetti);
            }
        }
        
        // Helper function to shuffle array
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }
        
        // Show feedback message
        function showFeedback(message, type) {
            feedbackElement.textContent = message;
            feedbackElement.className = `feedback ${type}`;
            
            if (type === 'success') {
                feedbackElement.innerHTML = `<i class="fas fa-check-circle"></i> ${message}`;
            } else {
                feedbackElement.innerHTML = `<i class="fas fa-times-circle"></i> ${message}`;
            }
            
            // Clear after 3 seconds
            setTimeout(() => {
                feedbackElement.textContent = '';
                feedbackElement.className = 'feedback';
            }, 3000);
        }
        
        // Show information popup for matched symbols
        function showInfoPopup(pairId) {
            // Find the symbol data
            const symbolData = symbolsData.find(symbol => symbol.id.toString() === pairId);
            if (!symbolData) return;
            
            // Pause the game timer
            clearInterval(gameTimer);
            
            // Update popup content
            document.getElementById("info-symbol").innerHTML = `<i class="${symbolData.symbol}"></i>`;
            document.getElementById("info-title").textContent = symbolData.meaning.split(' - ')[0];
            document.getElementById("info-meaning").textContent = symbolData.detail;
            document.getElementById("info-importance").textContent = symbolData.importance;
            document.getElementById("info-scenario").textContent = symbolData.scenario;
            
            // Update resource links
            const linksContainer = document.getElementById("info-links");
            linksContainer.innerHTML = '';
            
            symbolData.links.forEach(link => {
                const linkElement = document.createElement("a");
                linkElement.href = link.url;
                linkElement.className = "resource-link";
                linkElement.innerHTML = `<i class="${link.icon}"></i>${link.name}`;
                linksContainer.appendChild(linkElement);
            });
            
            // Show the popup
            document.getElementById("info-popup").style.display = "block";
            
            // Add event listeners for popup buttons
            document.getElementById("close-info").addEventListener("click", closeInfoPopup);
            
            // Auto-dismiss after 8 seconds
            setTimeout(closeInfoPopup, 8000);
        }
        
        // Close information popup
        function closeInfoPopup() {
            const infoPopup = document.getElementById("info-popup");
            
            // Add hiding class for animation
            infoPopup.classList.add("hiding");
            
            // Actually hide after animation completes
            setTimeout(() => {
                infoPopup.style.display = "none";
                infoPopup.classList.remove("hiding");
                
                // Restart the game timer if the game is not completed yet
                if (matchedPairs < totalPairs) {
                    startTimer();
                }
            }, 300);
            
            // Remove event listener to prevent duplicates
            document.getElementById("close-info").removeEventListener("click", closeInfoPopup);
        }
    </script>

<!-- Lenis Smooth Scrolling (CDN) -->
<script src="https://cdn.jsdelivr.net/gh/studio-freight/lenis@1.0.29/bundled/lenis.min.js"></script>

<!-- GSAP for scroll-triggered animations (optional but recommended) -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>

<!-- Lenis initialization script -->
<script>
    document.addEventListener('DOMContentLoaded', () => {
        // Initialize Lenis smooth scrolling with enhanced options
        const lenis = new Lenis({
            duration: 1.2,
            easing: (t) => Math.min(1, 1.001 - Math.pow(2, -10 * t)),
            direction: 'vertical',
            gestureDirection: 'vertical',
            smooth: true,
            smoothTouch: false,    // Disable on touch devices for better performance
            touchMultiplier: 2,
            wheelMultiplier: 1,    // Adjust wheel sensitivity
            lerp: 0.1,             // Lower values make scrolling smoother but less responsive
            infinite: false,       // Set to true for infinite scrolling pages
            orientation: 'vertical', // 'vertical' or 'horizontal'
            normalizeWheel: true,   // Normalizes wheel inputs across browsers
            smoothWheel: true      // Smooth mouse wheel scrolling
        });

        // Get scroll value for debugging or custom effects
        lenis.on('scroll', ({ scroll, limit, velocity, direction, progress }) => {
            // console.log({ scroll, limit, velocity, direction, progress });
            
            // You can use these values to trigger animations based on scroll position
            // Example: update a progress bar
            // document.querySelector('.progress-bar').style.width = `${progress * 100}%`;
        });

        // GSAP ScrollTrigger integration (if using GSAP)
        if (window.ScrollTrigger) {
            lenis.on('scroll', ScrollTrigger.update);
            
            gsap.ticker.add((time) => {
                lenis.raf(time * 1000);
            });
            
            gsap.ticker.lagSmoothing(0);
        } else {
            // Use requestAnimationFrame loop for smooth scrolling if not using GSAP
            function raf(time) {
                lenis.raf(time);
                requestAnimationFrame(raf);
            }
            requestAnimationFrame(raf);
        }

        // Handle anchor links for smooth scrolling to sections
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function(e) {
                e.preventDefault();
                
                const targetId = this.getAttribute('href');
                if (targetId === '#') return;
                
                const targetElement = document.querySelector(targetId);
                if (targetElement) {
                    // Scroll to the element
                    lenis.scrollTo(targetElement, {
                        offset: 0, // Adjust if you have fixed headers
                        immediate: false,
                        duration: 1.2,
                        easing: (t) => Math.min(1, 1.001 - Math.pow(2, -10 * t))
                    });
                }
            });
        });

        // Handle browser back/forward navigation
        if ('scrollRestoration' in history) {
            history.scrollRestoration = 'manual';
        }
        
        // Handle keyboard navigation (arrow keys, Page Up/Down, Home/End)
        window.addEventListener('keydown', (e) => {
            // Skip if typing in form elements
            if (['INPUT', 'TEXTAREA', 'SELECT'].includes(document.activeElement.tagName)) return;
            
            const currentPos = lenis.scroll;
            const scrollAmount = window.innerHeight * 0.9;
            
            switch (e.key) {
                case 'ArrowDown':
                case 'PageDown':
                    lenis.scrollTo(currentPos + scrollAmount);
                    e.preventDefault();
                    break;
                case 'ArrowUp':
                case 'PageUp':
                    lenis.scrollTo(currentPos - scrollAmount);
                    e.preventDefault();
                    break;
                case 'Home':
                    lenis.scrollTo(0);
                    e.preventDefault();
                    break;
                case 'End':
                    lenis.scrollTo(document.body.scrollHeight);
                    e.preventDefault();
                    break;
            }
        });

        // Optimize performance for mobile devices
        const isMobile = /Android|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
        if (isMobile) {
            lenis.options.lerp = 0.15; // Slightly faster response for mobile
            lenis.options.duration = 1; // Shorter animation time on mobile
        }

        // Handle resize events to recalculate dimensions
        window.addEventListener('resize', () => {
            lenis.resize();
        });

        // Stop scrolling when tab/window is not visible for performance
        document.addEventListener('visibilitychange', () => {
            if (document.hidden) {
                lenis.stop();
            } else {
                lenis.start();
            }
        });
    });
</script>

        <!-- Add the chatbot script reference -->
        <script src="/js/chatbot.js"></script>

</body>
</html>